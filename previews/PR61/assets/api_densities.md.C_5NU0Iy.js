import{_ as l,C as r,c as o,o as d,aA as a,j as i,G as t,a as n,w as p}from"./chunks/framework.C94wPBEO.js";const A=JSON.parse('{"title":"Reference and Target Densities","description":"","frontmatter":{},"headers":[],"relativePath":"api/densities.md","filePath":"api/densities.md","lastUpdated":null}'),c={name:"api/densities.md"},g={class:"jldocstring custom-block",open:""},h={class:"jldocstring custom-block",open:""},u={class:"jldocstring custom-block",open:""},k={class:"jldocstring custom-block",open:""},y={class:"jldocstring custom-block",open:""};function f(b,s,T,D,E,m){const e=r("Badge");return d(),o("div",null,[s[20]||(s[20]=a('<h1 id="Reference-and-Target-Densities" tabindex="-1">Reference and Target Densities <a class="header-anchor" href="#Reference-and-Target-Densities" aria-label="Permalink to &quot;Reference and Target Densities {#Reference-and-Target-Densities}&quot;">​</a></h1><h2 id="Index" tabindex="-1">Index <a class="header-anchor" href="#Index" aria-label="Permalink to &quot;Index {#Index}&quot;">​</a></h2><ul><li><a href="#TransportMaps.MapReferenceDensity"><code>TransportMaps.MapReferenceDensity</code></a></li><li><a href="#TransportMaps.MapTargetDensity"><code>TransportMaps.MapTargetDensity</code></a></li><li><a href="#Distributions.logpdf"><code>Distributions.logpdf</code></a></li><li><a href="#Distributions.pdf"><code>Distributions.pdf</code></a></li><li><a href="#TransportMaps.grad_logpdf"><code>TransportMaps.grad_logpdf</code></a></li></ul><h2 id="Types" tabindex="-1">Types <a class="header-anchor" href="#Types" aria-label="Permalink to &quot;Types {#Types}&quot;">​</a></h2>',4)),i("details",g,[i("summary",null,[s[0]||(s[0]=i("a",{id:"TransportMaps.MapTargetDensity",href:"#TransportMaps.MapTargetDensity"},[i("span",{class:"jlbinding"},"TransportMaps.MapTargetDensity")],-1)),s[1]||(s[1]=n()),t(e,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[3]||(s[3]=a(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MapTargetDensity</span></span></code></pre></div><p>Wrapper for target density functions used in transport map optimization. Stores the log-density function and its gradient, with support for automatic differentiation backends via DifferentiationInterface.jl.</p><p><strong>Fields</strong></p><ul><li><p><code>logdensity&lt;:Function</code>: Function computing log-density <code>log π(x)</code></p></li><li><p><code>ad_backend&lt;:Union{Nothing,ADTypes.AbstractADType}</code>: AD backend or <code>nothing</code> for analytical</p></li><li><p><code>grad_logdensity&lt;:Function</code>: Function computing gradient <code>∇ log π(x)</code></p></li><li><p><code>prepared_gradient</code>: Optional prepared gradient for performance (can be <code>nothing</code>)</p></li></ul><p><strong>Constructors</strong></p><ul><li><p><code>MapTargetDensity(logdensity, grad_logdensity)</code>: Provide both log-density and analytical gradient.</p></li><li><p><code>MapTargetDensity(logdensity, backend::ADTypes.AbstractADType, d::Int)</code>: Use AD backend with prepared gradient.</p></li><li><p><code>MapTargetDensity(logdensity, backend::ADTypes.AbstractADType)</code>: Use AD backend without preparation.</p></li><li><p><code>MapTargetDensity(logdensity)</code>: Use ForwardDiff.</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use ForwardDiff (default, not prepared)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MapTargetDensity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(logπ)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use ForwardDiff with prepared gradient (faster for repeated evaluations)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MapTargetDensity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(logπ, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AutoForwardDiff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), d)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use Mooncake with preparation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MapTargetDensity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(logπ, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AutoMooncake</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), d)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use FiniteDiff</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MapTargetDensity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(logπ, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AutoFiniteDiff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), d)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use analytical gradient</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">density </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MapTargetDensity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(logπ, grad_logπ)</span></span></code></pre></div>`,8)),t(e,{type:"info",class:"source-link",text:"source"},{default:p(()=>[...s[2]||(s[2]=[i("a",{href:"https://github.com/JuliaUQ/TransportMaps.jl/blob/da9368b028f1a439a17915636ed980c18a71a716/src/util/mapdensity.jl#L1-L37",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",h,[i("summary",null,[s[4]||(s[4]=i("a",{id:"TransportMaps.MapReferenceDensity",href:"#TransportMaps.MapReferenceDensity"},[i("span",{class:"jlbinding"},"TransportMaps.MapReferenceDensity")],-1)),s[5]||(s[5]=n()),t(e,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[7]||(s[7]=a('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MapReferenceDensity</span></span></code></pre></div><p>Wrapper for reference density (typically standard Gaussian) used in transport maps. The reference density defines the space from which samples are drawn and mapped to the target distribution.</p><p><strong>Fields</strong></p><ul><li><p><code>logdensity&lt;:Function</code>: Function computing log-density <code>log ρ(z)</code></p></li><li><p><code>ad_backend&lt;:ADTypes.AbstractADType</code>: AD backend for gradient computation</p></li><li><p><code>grad_logdensity&lt;:Function</code>: Function computing gradient <code>∇ log ρ(z)</code></p></li><li><p><code>densitytype::Distributions.UnivariateDistribution</code>: Univariate density type (e.g., <code>Normal()</code>)</p></li><li><p><code>prepared_gradient</code>: Prepared gradient for performance (can be <code>nothing</code>)</p></li></ul><p><strong>Constructors</strong></p><ul><li><p><code>MapReferenceDensity()</code>: Use standard normal with ForwardDiff (default, not prepared).</p></li><li><p><code>MapReferenceDensity(densitytype)</code>: Specify distribution with ForwardDiff (not prepared).</p></li><li><p><code>MapReferenceDensity(densitytype, backend)</code>: Specify distribution and AD backend (not prepared).</p></li><li><p><code>MapReferenceDensity(densitytype, backend, d)</code>: Specify distribution, AD backend, and dimension (prepared, recommended for performance).</p></li></ul>',6)),t(e,{type:"info",class:"source-link",text:"source"},{default:p(()=>[...s[6]||(s[6]=[i("a",{href:"https://github.com/JuliaUQ/TransportMaps.jl/blob/da9368b028f1a439a17915636ed980c18a71a716/src/util/mapdensity.jl#L78-L97",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[21]||(s[21]=i("h2",{id:"Functions",tabindex:"-1"},[n("Functions "),i("a",{class:"header-anchor",href:"#Functions","aria-label":'Permalink to "Functions {#Functions}"'},"​")],-1)),i("details",u,[i("summary",null,[s[8]||(s[8]=i("a",{id:"Distributions.pdf",href:"#Distributions.pdf"},[i("span",{class:"jlbinding"},"Distributions.pdf")],-1)),s[9]||(s[9]=n()),t(e,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[11]||(s[11]=a('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pdf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(density</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractMapDensity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x)</span></span></code></pre></div><p>Evaluate the probability density at point(s) <code>x</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>density::AbstractMapDensity</code>: Target or reference density</p></li><li><p><code>x</code>: Point (vector) or multiple points (matrix, rows are samples) at which to evaluate</p></li></ul><p><strong>Returns</strong></p><ul><li>Scalar density value for vector input, or vector of densities for matrix input</li></ul><p><strong>Note</strong></p><p>This computes <code>exp(logpdf(density, x))</code>. For numerical stability, prefer using <code>logpdf</code> when possible.</p>',8)),t(e,{type:"info",class:"source-link",text:"source"},{default:p(()=>[...s[10]||(s[10]=[i("a",{href:"https://github.com/JuliaUQ/TransportMaps.jl/blob/da9368b028f1a439a17915636ed980c18a71a716/src/util/mapdensity.jl#L203-L217",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",k,[i("summary",null,[s[12]||(s[12]=i("a",{id:"Distributions.logpdf",href:"#Distributions.logpdf"},[i("span",{class:"jlbinding"},"Distributions.logpdf")],-1)),s[13]||(s[13]=n()),t(e,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[15]||(s[15]=a('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">logpdf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(density</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractMapDensity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x)</span></span></code></pre></div><p>Evaluate the log-density at point(s) <code>x</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>density::AbstractMapDensity</code>: Target or reference density</p></li><li><p><code>x</code>: Point (vector) or multiple points (matrix, rows are samples) at which to evaluate</p></li></ul><p><strong>Returns</strong></p><ul><li>Scalar log-density value for vector input, or vector of log-densities for matrix input</li></ul>',6)),t(e,{type:"info",class:"source-link",text:"source"},{default:p(()=>[...s[14]||(s[14]=[i("a",{href:"https://github.com/JuliaUQ/TransportMaps.jl/blob/da9368b028f1a439a17915636ed980c18a71a716/src/util/mapdensity.jl#L144-L155",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",y,[i("summary",null,[s[16]||(s[16]=i("a",{id:"TransportMaps.grad_logpdf",href:"#TransportMaps.grad_logpdf"},[i("span",{class:"jlbinding"},"TransportMaps.grad_logpdf")],-1)),s[17]||(s[17]=n()),t(e,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[19]||(s[19]=a('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">grad_logpdf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(density</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractMapDensity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x)</span></span></code></pre></div><p>Evaluate the gradient of log-density at point(s) <code>x</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>density::AbstractMapDensity</code>: Target or reference density</p></li><li><p><code>x</code>: Point (vector) or multiple points (matrix, rows are samples) at which to evaluate</p></li></ul><p><strong>Returns</strong></p><ul><li>Gradient vector for vector input, or matrix of gradients (one per row) for matrix input</li></ul>',6)),t(e,{type:"info",class:"source-link",text:"source"},{default:p(()=>[...s[18]||(s[18]=[i("a",{href:"https://github.com/JuliaUQ/TransportMaps.jl/blob/da9368b028f1a439a17915636ed980c18a71a716/src/util/mapdensity.jl#L170-L181",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})])])}const F=l(c,[["render",f]]);export{A as __pageData,F as default};
