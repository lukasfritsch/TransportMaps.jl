import{_ as l,c as n,o as e,j as s,aA as t,a}from"./chunks/framework.C94wPBEO.js";const h="/TransportMaps.jl/previews/PR61/assets/atm-indices.qPRhYPS1.svg",p="/TransportMaps.jl/previews/PR61/assets/atm-comparison-target.BMyE2Epu.svg",k="/TransportMaps.jl/previews/PR61/assets/atm-density-comparison.HL4-Pivt.svg",r="/TransportMaps.jl/previews/PR61/assets/iterations.DH66PS9y.svg",d="/TransportMaps.jl/previews/PR61/assets/objectives.bRDFYGB5.svg",H=JSON.parse('{"title":"Banana: Adaptive Transport Map from Samples","description":"","frontmatter":{},"headers":[],"relativePath":"Examples/banana_adaptive.md","filePath":"Examples/banana_adaptive.md","lastUpdated":null}'),g={name:"Examples/banana_adaptive.md"},E={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},o={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.672ex",height:"2.565ex",role:"img",focusable:"false",viewBox:"0 -883.9 10905.1 1133.9","aria-hidden":"true"},y={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.348ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -694 596 899","aria-hidden":"true"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"8.42ex",height:"1.731ex",role:"img",focusable:"false",viewBox:"0 -683 3721.6 765","aria-hidden":"true"},F={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},c={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.429ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -705 2399.6 899","aria-hidden":"true"},u={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},C={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.186ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.327ex",height:"1.756ex",role:"img",focusable:"false",viewBox:"0 -694 2354.6 776","aria-hidden":"true"},x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},b={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.029ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2222.7 1000","aria-hidden":"true"};function A(v,i,w,B,f,D){return e(),n("div",null,[i[25]||(i[25]=s("h1",{id:"Banana:-Adaptive-Transport-Map-from-Samples",tabindex:"-1"},[a("Banana: Adaptive Transport Map from Samples "),s("a",{class:"header-anchor",href:"#Banana:-Adaptive-Transport-Map-from-Samples","aria-label":'Permalink to "Banana: Adaptive Transport Map from Samples {#Banana:-Adaptive-Transport-Map-from-Samples}"'},"​")],-1)),i[26]||(i[26]=s("p",null,[a("This implements the ATM algorithm from ["),s("a",{href:"/TransportMaps.jl/previews/PR61/references#baptista2023"},"3"),a("] to approximate the banana distribution using an adaptive polynomial transport map.")],-1)),i[27]||(i[27]=s("p",null,"As an example, we once again consider the banana distribution defined by the density:",-1)),s("mjx-container",E,[(e(),n("svg",o,[...i[0]||(i[0]=[t("",1)])])),i[1]||(i[1]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("mi",null,"p"),s("mo",{stretchy:"false"},"("),s("mi",null,"x"),s("mo",{stretchy:"false"},")"),s("mo",null,"="),s("mi",null,"ϕ"),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"x"),s("mn",null,"1")]),s("mo",{stretchy:"false"},")"),s("mo",null,"⋅"),s("mi",null,"ϕ"),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"x"),s("mn",null,"2")]),s("mo",null,"−"),s("msubsup",null,[s("mi",null,"x"),s("mn",null,"1"),s("mn",null,"2")]),s("mo",{stretchy:"false"},")")])],-1))]),s("p",null,[i[4]||(i[4]=a("where ",-1)),s("mjx-container",y,[(e(),n("svg",T,[...i[2]||(i[2]=[s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D719",d:"M409 688Q413 694 421 694H429H442Q448 688 448 686Q448 679 418 563Q411 535 404 504T392 458L388 442Q388 441 397 441T429 435T477 418Q521 397 550 357T579 260T548 151T471 65T374 11T279 -10H275L251 -105Q245 -128 238 -160Q230 -192 227 -198T215 -205H209Q189 -205 189 -198Q189 -193 211 -103L234 -11Q234 -10 226 -10Q221 -10 206 -8T161 6T107 36T62 89T43 171Q43 231 76 284T157 370T254 422T342 441Q347 441 348 445L378 567Q409 686 409 688ZM122 150Q122 116 134 91T167 53T203 35T237 27H244L337 404Q333 404 326 403T297 395T255 379T211 350T170 304Q152 276 137 237Q122 191 122 150ZM500 282Q500 320 484 347T444 385T405 400T381 404H378L332 217L284 29Q284 27 285 27Q293 27 317 33T357 47Q400 66 431 100T475 170T494 234T500 282Z",style:{"stroke-width":"3"}})])])],-1)])])),i[3]||(i[3]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"ϕ")])],-1))]),i[5]||(i[5]=a(" is the standard normal PDF.",-1))]),i[28]||(i[28]=t("",3)),s("p",null,[i[8]||(i[8]=a("The generation of samples from the banana distribution is done in the same way as in the example ",-1)),i[9]||(i[9]=s("a",{href:"/TransportMaps.jl/previews/PR61/Examples/banana_mapfromsamples#Banana:-Map-from-Samples"},"Banana: Map from Samples",-1)),i[10]||(i[10]=a(". Here, we use ",-1)),s("mjx-container",m,[(e(),n("svg",Q,[...i[6]||(i[6]=[t("",1)])])),i[7]||(i[7]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"N"),s("mo",null,"="),s("mn",null,"500")])],-1))]),i[11]||(i[11]=a(" samples for the ATM learning.",-1))]),i[29]||(i[29]=t("",6)),s("p",null,[i[16]||(i[16]=a("Then, we perform adaptive transport map learning with k-fold cross-validation. We use the setup as in [",-1)),i[17]||(i[17]=s("a",{href:"/TransportMaps.jl/previews/PR61/references#baptista2023"},"3",-1)),i[18]||(i[18]=a("]: We select a Hermite basis with linearization, use the modified Softplus rectifier with parameter ",-1)),s("mjx-container",F,[(e(),n("svg",c,[...i[12]||(i[12]=[t("",1)])])),i[13]||(i[13]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"β"),s("mo",null,"="),s("mn",null,"2")])],-1))]),i[19]||(i[19]=a(" and ",-1)),s("mjx-container",u,[(e(),n("svg",C,[...i[14]||(i[14]=[t("",1)])])),i[15]||(i[15]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"k"),s("mo",null,"="),s("mn",null,"5")])],-1))]),i[20]||(i[20]=a(" folds. We set the maximum number of terms to 3 and 6 for the two components, respectively.",-1))]),i[30]||(i[30]=t("",24)),s("p",null,[i[23]||(i[23]=a("We can see that in the last iteration, the interaction term ",-1)),s("mjx-container",x,[(e(),n("svg",b,[...i[21]||(i[21]=[t("",1)])])),i[22]||(i[22]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mo",{stretchy:"false"},"("),s("mn",null,"1"),s("mo",null,","),s("mn",null,"1"),s("mo",{stretchy:"false"},")")])],-1))]),i[24]||(i[24]=a(" was added. However, in the end, this term was not selected in the final map based on the cross-validation. To better understand the selection, we can also plot the training and test objectives over the iterations:",-1))]),i[31]||(i[31]=t("",6))])}const M=l(g,[["render",A]]);export{H as __pageData,M as default};
