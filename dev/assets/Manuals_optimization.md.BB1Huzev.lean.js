import{_ as l,c as t,o as e,aA as n,j as s,a as i}from"./chunks/framework.B3XhNAgv.js";const h="/TransportMaps.jl/dev/assets/optimization-conv.BkKWNkse.svg",V=JSON.parse('{"title":"Optimization of the Map Coefficients","description":"","frontmatter":{},"headers":[],"relativePath":"Manuals/optimization.md","filePath":"Manuals/optimization.md","lastUpdated":null}'),p={name:"Manuals/optimization.md"},k={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},r={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.018ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.432ex",height:"1.041ex",role:"img",focusable:"false",viewBox:"0 -452 633 460","aria-hidden":"true"},d={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},Q={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.593ex",height:"1.532ex",role:"img",focusable:"false",viewBox:"0 -677 704 677","aria-hidden":"true"},T={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},o={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"53.872ex",height:"6.74ex",role:"img",focusable:"false",viewBox:"0 -1733 23811.6 2978.9","aria-hidden":"true"},g={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},m={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.541ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2007 1000","aria-hidden":"true"},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},y={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.459ex",height:"1.645ex",role:"img",focusable:"false",viewBox:"0 -705 645 727","aria-hidden":"true"},E={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.819ex"},xmlns:"http://www.w3.org/2000/svg",width:"48.351ex",height:"6.74ex",role:"img",focusable:"false",viewBox:"0 -1733 21371.3 2978.9","aria-hidden":"true"},f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},F={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.783ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.277ex",height:"2.697ex",role:"img",focusable:"false",viewBox:"0 -846 3216.6 1191.9","aria-hidden":"true"},x={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},H={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.559ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1573 1000","aria-hidden":"true"};function C(w,a,b,v,M,D){return e(),t("div",null,[a[28]||(a[28]=n("",4)),s("p",null,[a[4]||(a[4]=i("Formally, we define the following optimization problem to determine the coefficients ",-1)),s("mjx-container",k,[(e(),t("svg",r,[...a[0]||(a[0]=[s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D482",d:"M222 -8Q140 -8 89 34T38 158Q38 191 48 227Q72 329 151 390T327 452Q361 452 385 443T421 425T433 416H434L441 421Q448 426 460 430T486 435Q509 435 523 422T538 386Q538 380 522 315T488 179T467 93Q466 87 466 72Q466 42 483 42Q505 42 521 75Q531 94 541 134Q546 155 550 158T571 162H576H587Q607 162 607 148Q606 142 604 132T590 94T566 47T528 9T474 -8Q396 -8 358 40Q295 -8 222 -8ZM404 351Q383 401 324 401Q300 401 270 385T221 330Q206 296 186 220Q166 136 166 106Q166 72 184 58T228 43Q256 43 284 57T328 84T343 103Q343 106 374 228L404 351Z",style:{"stroke-width":"3"}})])])],-1)])])),a[1]||(a[1]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",{mathvariant:"bold-italic"},"a")])],-1))]),a[5]||(a[5]=i(" of the parameterized map ",-1)),s("mjx-container",d,[(e(),t("svg",Q,[...a[2]||(a[2]=[s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D447",d:"M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z",style:{"stroke-width":"3"}})])])],-1)])])),a[3]||(a[3]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"T")])],-1))]),a[6]||(a[6]=i(":",-1))]),s("mjx-container",T,[(e(),t("svg",o,[...a[7]||(a[7]=[n("",1)])])),a[8]||(a[8]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("munder",null,[s("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold-italic"},"a")])]),s("munderover",null,[s("mo",{"data-mjx-texclass":"OP"},"∑"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mo",null,"="),s("mn",null,"1")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"N")])]),s("msub",null,[s("mi",null,"w"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"q"),s("mo",null,","),s("mi",null,"i")])]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",{minsize:"1.623em",maxsize:"1.623em"},"[")]),s("mo",null,"−"),s("mi",null,"log"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mi",null,"π"),s("mrow",{"data-mjx-texclass":"OPEN"},[s("mo",{minsize:"1.2em",maxsize:"1.2em"},"(")]),s("mi",null,"T"),s("mo",{stretchy:"false"},"("),s("mi",{mathvariant:"bold-italic"},"a"),s("mo",null,","),s("msub",null,[s("mi",{mathvariant:"bold-italic"},"z"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"q"),s("mo",null,","),s("mi",null,"i")])]),s("mo",{stretchy:"false"},")"),s("mrow",{"data-mjx-texclass":"CLOSE"},[s("mo",{minsize:"1.2em",maxsize:"1.2em"},")")]),s("mo",null,"−"),s("mi",null,"log"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"det"),s("mi",{mathvariant:"normal"},"∇"),s("mi",null,"T"),s("mo",{stretchy:"false"},"("),s("mi",{mathvariant:"bold-italic"},"a"),s("mo",null,","),s("msub",null,[s("mi",{mathvariant:"bold-italic"},"z"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"q"),s("mo",null,","),s("mi",null,"i")])]),s("mo",{stretchy:"false"},")"),s("mo",{"data-mjx-texclass":"ORD",stretchy:"false"},"|"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mo",{minsize:"1.623em",maxsize:"1.623em"},"]")])])],-1))]),s("p",null,[a[11]||(a[11]=i("As noted by [",-1)),a[12]||(a[12]=s("a",{href:"/TransportMaps.jl/dev/references#marzouk2016"},"1",-1)),a[13]||(a[13]=i("], this optimization problem is generally non-convex. Specifically, it is only convex when the target density ",-1)),s("mjx-container",g,[(e(),t("svg",m,[...a[9]||(a[9]=[n("",1)])])),a[10]||(a[10]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"π"),s("mo",{stretchy:"false"},"("),s("mi",{mathvariant:"bold-italic"},"x"),s("mo",{stretchy:"false"},")")])],-1))]),a[14]||(a[14]=i(" is log-concave. Especially in Bayesian inference, where the target density represents the posterior density, the function is not log-concave, resulting in a non-convex optimization problem.",-1))]),a[29]||(a[29]=n("",43)),s("p",null,[a[17]||(a[17]=i("When the map is constructed from samples, the optimization problem is formulated by minimizing the Kullback-Leibler divergence between the pushforward of the reference density and the empirical distribution of the samples. We denote the transport map by ",-1)),s("mjx-container",c,[(e(),t("svg",y,[...a[15]||(a[15]=[s("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[s("g",{"data-mml-node":"math"},[s("g",{"data-mml-node":"mi"},[s("path",{"data-c":"1D446",d:"M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z",style:{"stroke-width":"3"}})])])],-1)])])),a[16]||(a[16]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"S")])],-1))]),a[18]||(a[18]=i(", which pushes forward the target distribution to the reference distribution. This leads to the following optimization problem:",-1))]),s("mjx-container",E,[(e(),t("svg",u,[...a[19]||(a[19]=[n("",1)])])),a[20]||(a[20]=s("mjx-assistive-mml",{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("munder",null,[s("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"min"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",{mathvariant:"bold-italic"},"a")])]),s("mo",null,"−"),s("mfrac",null,[s("mn",null,"1"),s("mi",null,"M")]),s("munderover",null,[s("mo",{"data-mjx-texclass":"OP"},"∑"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mo",null,"="),s("mn",null,"1")]),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"M")])]),s("mi",null,"log"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mi",null,"ρ"),s("mrow",{"data-mjx-texclass":"INNER"},[s("mo",{"data-mjx-texclass":"OPEN"},"("),s("mi",null,"S"),s("mo",{stretchy:"false"},"("),s("mi",{mathvariant:"bold-italic"},"a"),s("mo",null,","),s("msub",null,[s("mi",{mathvariant:"bold-italic"},"x"),s("mi",null,"i")]),s("mo",{stretchy:"false"},")"),s("mo",{"data-mjx-texclass":"CLOSE"},")")]),s("mo",null,"−"),s("mi",null,"log"),s("mo",{"data-mjx-texclass":"NONE"},"⁡"),s("mrow",{"data-mjx-texclass":"INNER"},[s("mo",{"data-mjx-texclass":"OPEN"},"|"),s("mo",{"data-mjx-texclass":"OP",movablelimits:"true"},"det"),s("mi",{mathvariant:"normal"},"∇"),s("mi",null,"S"),s("mo",{stretchy:"false"},"("),s("mi",{mathvariant:"bold-italic"},"a"),s("mo",null,","),s("msub",null,[s("mi",{mathvariant:"bold-italic"},"x"),s("mi",null,"i")]),s("mo",{stretchy:"false"},")"),s("mo",{"data-mjx-texclass":"CLOSE"},"|")])])],-1))]),s("p",null,[a[25]||(a[25]=i("where ",-1)),s("mjx-container",f,[(e(),t("svg",F,[...a[21]||(a[21]=[n("",1)])])),a[22]||(a[22]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mo",{fence:"false",stretchy:"false"},"{"),s("msub",null,[s("mi",{mathvariant:"bold-italic"},"x"),s("mi",null,"i")]),s("msubsup",null,[s("mo",{fence:"false",stretchy:"false"},"}"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"i"),s("mo",null,"="),s("mn",null,"1")]),s("mi",null,"M")])])],-1))]),a[26]||(a[26]=i(" are samples from the target distribution, and ",-1)),s("mjx-container",x,[(e(),t("svg",H,[...a[23]||(a[23]=[n("",1)])])),a[24]||(a[24]=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"ρ"),s("mo",{stretchy:"false"},"("),s("mo",null,"⋅"),s("mo",{stretchy:"false"},")")])],-1))]),a[27]||(a[27]=i(" is the density of the reference distribution.",-1))]),a[30]||(a[30]=n("",4))])}const _=l(p,[["render",C]]);export{V as __pageData,_ as default};
