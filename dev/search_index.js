var documenterSearchIndex = {"docs":
[{"location":"references/#References","page":"References","title":"References","text":"","category":"section"},{"location":"references/","page":"References","title":"References","text":"Y.¬†Marzouk, T.¬†Moselhy, M.¬†Parno and A.¬†Spantini. Sampling via Measure Transport: An Introduction. In: Handbook of Uncertainty Quantification, edited by R.¬†Ghanem, D.¬†Higdon and H.¬†Owhadi (Springer International Publishing, Cham, 2016); pp.¬†1‚Äì41. Accessed on Nov 4, 2024.\n\n\n\nM.¬†Ramgraber, D.¬†Sharp, M.¬†L.¬†Provost and Y.¬†Marzouk. A Friendly Introduction to Triangular Transport (Mar 2025), arXiv:2503.21673 [stat]. Accessed on Apr 7, 2025.\n\n\n\nR.¬†Baptista, Y.¬†Marzouk and O.¬†Zahm. On the Representation and Learning of Monotone Triangular Transport Maps. Foundations¬†of¬†Computational¬†Mathematics (2023).\n\n\n\nJ.¬†Grashorn, M.¬†Broggi, L.¬†Chamoin and M.¬†Beer. Efficiency Comparison of MCMC and Transport Map Bayesian Posterior Estimation for Structural Health Monitoring. Mechanical¬†Systems¬†and¬†Signal¬†Processing 216, 111440 (2024).\n\n\n\nM.¬†Rosenblatt. Remarks on a multivariate transformation. The¬†annals¬†of¬†mathematical¬†statistics 23, 470‚Äì472 (1952).\n\n\n\nH.¬†Knothe. Contributions to the theory of convex bodies. The¬†Michigan¬†Mathematical¬†Journal 4, 39‚Äì52 (1957).\n\n\n\nM.¬†Parno, P.-B.¬†Rubio, D.¬†Sharp, M.¬†Brennan, R.¬†Baptista, H.¬†Bonart and Y.¬†Marzouk. MParT: Monotone Parameterization Toolkit. Journal¬†of¬†Open¬†Source¬†Software 7, 4843 (2022).\n\n\n\nB.¬†Zanger, O.¬†Zahm, T.¬†Cui and M.¬†Schreiber. Sequential Transport Maps Using SoS Density Estimation and alpha``-Divergences (Oct 2024), arXiv:2402.17943 [stat]. Accessed on Apr 8, 2025.\n\n\n\nA.¬†B.¬†Sullivan, D.¬†M.¬†Snyder and S.¬†A.¬†Rounds. Controls on biochemical oxygen demand in the upper Klamath River, Oregon. Chemical¬†Geology 269, 12‚Äì21 (2010).\n\n\n\n","category":"page"},{"location":"api/#API-Reference","page":"API","title":"API Reference","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"This page provides a comprehensive reference for all exported functions and types in TransportMaps.jl.","category":"page"},{"location":"api/#Transport-Maps","page":"API","title":"Transport Maps","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"This will be added later.","category":"page"},{"location":"Examples/banana_example/#Banana-Distribution-Example","page":"Banana Distribution","title":"Banana Distribution Example","text":"","category":"section"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"This example demonstrates how to use TransportMaps.jl to approximate a \"banana\" distribution using polynomial transport maps.","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"The banana distribution is a common test case in transport map literature [1], defined as a standard normal in the first dimension and a normal distribution centered at x‚ÇÅ¬≤ in the second dimension. This example showcases the effectiveness of triangular transport maps for capturing nonlinear dependencies [3].","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"We start with the necessary packages:","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"using TransportMaps\nusing Distributions\nusing Plots","category":"page"},{"location":"Examples/banana_example/#Creating-the-Transport-Map","page":"Banana Distribution","title":"Creating the Transport Map","text":"","category":"section"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"We start by creating a 2-dimensional polynomial transport map with degree 2 and a Softplus rectifier function.","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"M = PolynomialMap(2, 2, Normal(), Softplus())","category":"page"},{"location":"Examples/banana_example/#Setting-up-Quadrature","page":"Banana Distribution","title":"Setting up Quadrature","text":"","category":"section"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"For optimization, we need to specify quadrature weights. Here we use Gauss-Hermite quadrature with 3 points per dimension.","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"quadrature = GaussHermiteWeights(3, 2)","category":"page"},{"location":"Examples/banana_example/#Defining-the-Target-Density","page":"Banana Distribution","title":"Defining the Target Density","text":"","category":"section"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"The banana distribution has the density:","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"p(x) = phi(x_1) cdot phi(x_2 - x_1^2)","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"where phi is the standard normal PDF.","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"target_density(x) = pdf(Normal(), x[1]) * pdf(Normal(), x[2] - x[1]^2)\nnothing # hide","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"Create a MapTargetDensity object for optimization","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"target = MapTargetDensity(target_density, :auto_diff)","category":"page"},{"location":"Examples/banana_example/#Optimizing-the-Map","page":"Banana Distribution","title":"Optimizing the Map","text":"","category":"section"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"Now we optimize the map coefficients to approximate the target density:","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"@time res = optimize!(M, target, quadrature)\nprintln(\"Optimization result: \", res)","category":"page"},{"location":"Examples/banana_example/#Testing-the-Map","page":"Banana Distribution","title":"Testing the Map","text":"","category":"section"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"Let's generate some samples from the standard normal distribution and map them through our optimized transport map:","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"samples_z = randn(1000, 2)","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"Map the samples through our transport map:","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"mapped_samples = reduce(vcat, [evaluate(M, x)' for x in eachrow(samples_z)])","category":"page"},{"location":"Examples/banana_example/#Visualizing-Results","page":"Banana Distribution","title":"Visualizing Results","text":"","category":"section"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"Let's create a scatter plot of the mapped samples to see how well our transport map approximates the banana distribution:","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"scatter(mapped_samples[:, 1], mapped_samples[:, 2],\n           label=\"Mapped Samples\", alpha=0.5, color=2,\n           title=\"Transport Map Approximation of Banana Distribution\",\n           xlabel=\"x‚ÇÅ\", ylabel=\"x‚ÇÇ\")\nsavefig(\"samples-banana.svg\"); nothing # hide","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"(Image: Banana Samples)","category":"page"},{"location":"Examples/banana_example/#Quality-Assessment","page":"Banana Distribution","title":"Quality Assessment","text":"","category":"section"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"We can assess the quality of our approximation using the variance diagnostic:","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"var_diag = variance_diagnostic(M, target, samples_z)\nprintln(\"Variance Diagnostic: \", var_diag)","category":"page"},{"location":"Examples/banana_example/#Interpretation","page":"Banana Distribution","title":"Interpretation","text":"","category":"section"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"The variance diagnostic provides a measure of how well the transport map approximates the target distribution. Lower values indicate better approximation.","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"The scatter plot should show the characteristic \"banana\" shape, with samples curved according to the relationship x‚ÇÇ ‚âà x‚ÇÅ¬≤.","category":"page"},{"location":"Examples/banana_example/#Further-Experiments","page":"Banana Distribution","title":"Further Experiments","text":"","category":"section"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"You can experiment with:","category":"page"},{"location":"Examples/banana_example/","page":"Banana Distribution","title":"Banana Distribution","text":"Different polynomial degrees (see [3] for monotone map theory)\nDifferent rectifier functions (IdentityRectifier(), ShiftedELU())\nDifferent quadrature methods (MonteCarloWeights, LatinHypercubeWeights)\nMore quadrature points for higher accuracy","category":"page"},{"location":"getting_started/#Getting-Started-with-TransportMaps.jl","page":"Getting Started","title":"Getting Started with TransportMaps.jl","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"This guide will help you get started with TransportMaps.jl for constructing and using transport maps.","category":"page"},{"location":"getting_started/#Basic-Concepts","page":"Getting Started","title":"Basic Concepts","text":"","category":"section"},{"location":"getting_started/#What-is-a-Transport-Map?","page":"Getting Started","title":"What is a Transport Map?","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"A transport map T is a function that transforms samples from a reference distribution (typically standard Gaussian) to a target distribution [1]. The key property is that if X sim rho_0 (reference) and Y = T(X), then Y sim rho_1 (target).","category":"page"},{"location":"getting_started/#Triangular-Maps","page":"Getting Started","title":"Triangular Maps","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"TransportMaps.jl focuses on triangular transport maps [3], where:","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"T(boldsymbolx) =\nleft(beginarrayc\nT_1(x_1) \nT_2(x_1 x_2) \nT_3(x_1 x_2 x_3) \nvdots \nT_n(x_1 x_2 dots x_n)\nendarray\nright)","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"This structure ensures that the map is invertible and the Jacobian determinant is easy to compute. The construction follows the Knothe-Rosenblatt rearrangement [6].","category":"page"},{"location":"getting_started/#First-Example:-A-Simple-2D-Transport-Map","page":"Getting Started","title":"First Example: A Simple 2D Transport Map","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"using TransportMaps\nusing Distributions\nusing Random\nusing Plots\nusing LinearAlgebra","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Let's create a simple 2D transport map:","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Set random seed for reproducibility","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Random.seed!(1234)\nnothing # hide","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Create a 2D polynomial map with degree 2","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"M = PolynomialMap(2, 2, Normal(), Softplus())","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"The map is initially identity (coefficients are zero)","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"println(\"Initial coefficients: \", getcoefficients(M))","category":"page"},{"location":"getting_started/#Defining-a-Target-Distribution","page":"Getting Started","title":"Defining a Target Distribution","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"For optimization, you need to define your target probability density. Let's start with a simple correlated Gaussian:","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Example: Correlated Gaussian","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"function correlated_gaussian(x; œÅ=0.8)\n    Œ£ = [1.0 œÅ; œÅ 1.0]\n    return pdf(MvNormal(zeros(2), Œ£), x)\nend\nnothing # hide","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Create a MapTargetDensity object for optimization","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"target_density = MapTargetDensity(correlated_gaussian, :auto_diff)","category":"page"},{"location":"getting_started/#Setting-up-Quadrature","page":"Getting Started","title":"Setting up Quadrature","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Choose an appropriate quadrature scheme for map optimization:","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Gauss-Hermite quadrature (good for Gaussian-like targets)","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"quadrature = GaussHermiteWeights(5, 2)  # 5 points per dimension, 2D","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Alternative options (commented out): quadrature = MonteCarloWeights(1000, 2)  # 1000 samples, 2D quadrature = LatinHypercubeWeights(1000, 2)","category":"page"},{"location":"getting_started/#Optimizing-the-Map","page":"Getting Started","title":"Optimizing the Map","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Fit the transport map to your target distribution:","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"println(\"Optimizing the map...\")\n@time result = optimize!(M, target_density, quadrature)\n\nprintln(\"Optimization result: \", result)\nprintln(\"Final coefficients: \", getcoefficients(M))","category":"page"},{"location":"getting_started/#Generating-Samples","page":"Getting Started","title":"Generating Samples","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Once optimized, use the map to generate samples:","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Generate reference samples (standard Gaussian)","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"n_samples = 1000\nreference_samples = randn(n_samples, 2)","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Transform to target distribution","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"target_samples = zeros(n_samples, 2)\nfor i in 1:n_samples\n    target_samples[i, :] = evaluate(M, reference_samples[i, :])\nend","category":"page"},{"location":"getting_started/#Visualizing-Results","page":"Getting Started","title":"Visualizing Results","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Let's plot both the reference and target samples:","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"p1 = scatter(reference_samples[:, 1], reference_samples[:, 2],\n            alpha=0.6, title=\"Reference Samples\",\n            xlabel=\"Z‚ÇÅ\", ylabel=\"Z‚ÇÇ\", legend=false, aspect_ratio=:equal)\n\np2 = scatter(target_samples[:, 1], target_samples[:, 2],\n            alpha=0.6, title=\"Target Samples\",\n            xlabel=\"X‚ÇÅ\", ylabel=\"X‚ÇÇ\", legend=false, aspect_ratio=:equal)\n\nplot(p1, p2, layout=(1,2), size=(800, 400))\nsavefig(\"samples.svg\"); nothing # hide","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"(Image: Transport Map Samples)","category":"page"},{"location":"getting_started/#Evaluating-Map-Quality","page":"Getting Started","title":"Evaluating Map Quality","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Check how well your map approximates the target:","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Variance diagnostic (should be close to 1 for good maps)","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"var_diag = variance_diagnostic(M, target_density, reference_samples)\nprintln(\"Variance diagnostic: \", var_diag)","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"You can also check the Jacobian determinant","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"sample_point = [0.0, 0.0]\njac = jacobian(M, sample_point)\ndet_jac = det(jac)\nprintln(\"Jacobian determinant at origin: \", det_jac)","category":"page"},{"location":"getting_started/#Working-with-Different-Rectifiers","page":"Getting Started","title":"Working with Different Rectifiers","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"The rectifier function affects the map's behavior. Let's compare different options:","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"ShiftedELU rectifier","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"M_elu = PolynomialMap(2, 2, Normal(), ShiftedELU())\nresult_elu = optimize!(M_elu, target_density, quadrature)\nvar_diag_elu = variance_diagnostic(M_elu, target_density, reference_samples)\n\nprintln(\"Variance diagnostics:\")\nprintln(\"  Softplus: \", var_diag)\nprintln(\"  ShiftedELU: \", var_diag_elu)","category":"page"},{"location":"getting_started/#More-Complex-Example:-Banana-Distribution","page":"Getting Started","title":"More Complex Example: Banana Distribution","text":"","category":"section"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Now let's try a more challenging target - the banana distribution:","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Define banana density","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"banana_density(x) = pdf(Normal(), x[1]) * pdf(Normal(), x[2] - x[1]^2)\ntarget_density_banana = MapTargetDensity(banana_density, :auto_diff)","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Create a new map for this target","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"M_banana = PolynomialMap(2, 2, Normal(), Softplus())\nresult_banana = optimize!(M_banana, target_density_banana, quadrature)","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Display optimized map","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"display(M_banana)","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Generate samples","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"banana_samples = zeros(n_samples, 2)\nfor i in 1:n_samples\n    banana_samples[i, :] = evaluate(M_banana, reference_samples[i, :])\nend","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Visualize the banana distribution","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"x1_grid = range(-3, 3, length=100)\nx2_grid = range(-3, 6, length=100)\nposterior_values = [banana_density([x‚ÇÅ, x‚ÇÇ]) for x‚ÇÇ in x2_grid, x‚ÇÅ in x1_grid]\n\nscatter(banana_samples[:, 1], banana_samples[:, 2],\n        alpha=0.6, title=\"Banana Distribution Samples\",\n        xlabel=\"X‚ÇÅ\", ylabel=\"X‚ÇÇ\", legend=false, aspect_ratio=:equal)\ncontour!(x1_grid, x2_grid, posterior_values, colormap=:viridis, label=\"Posterior Density\")\nsavefig(\"banana_samples.svg\"); nothing # hide","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"(Image: Banana Distribution Samples)","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"Check quality","category":"page"},{"location":"getting_started/","page":"Getting Started","title":"Getting Started","text":"var_diag_banana = variance_diagnostic(M_banana, target_density_banana, reference_samples)\nprintln(\"Banana distribution variance diagnostic: \", var_diag_banana)","category":"page"},{"location":"Examples/bod_example/#Biochemical-Oxygen-Demand-(BOD)-Example","page":"BOD Parameter Estimation","title":"Biochemical Oxygen Demand (BOD) Example","text":"","category":"section"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"This example demonstrates Bayesian parameter estimation for a biochemical oxygen demand model using transport maps. The problem comes from environmental engineering and was originally presented in [9] and later used as a benchmark in transport map applications [1].","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"The model describes the evolution of biochemical oxygen demand (BOD) in a river system using an exponential growth model with two uncertain parameters controlling growth and decay rates.","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"using TransportMaps\nusing Plots\nusing Distributions\nusing SpecialFunctions","category":"page"},{"location":"Examples/bod_example/#The-Forward-Model","page":"BOD Parameter Estimation","title":"The Forward Model","text":"","category":"section"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"The BOD model is given by:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"mathcalB(t) = A(1-exp(-Bt))+mathcalE","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"where the parameters A and B are functions of the uncertain inputs Œ∏‚ÇÅ and Œ∏‚ÇÇ:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"beginaligned\nA = 04 + 04left(1 + texterfleft(fractheta_1sqrt2 right)right) \nB = 001 + 015left(1 + texterfleft(fractheta_2sqrt2 right)right)\nendaligned","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"and ‚Ñ∞ ~ ùí©(0, 10‚Åª¬≥) represents measurement noise.","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"function forward_model(t, x)\n    A = 0.4 + 0.4 * (1 + erf(x[1] / sqrt(2)))\n    B = 0.01 + 0.15 * (1 + erf(x[2] / sqrt(2)))\n    return A * (1 - exp(-B * t))\nend\nnothing # hide","category":"page"},{"location":"Examples/bod_example/#Experimental-Data","page":"BOD Parameter Estimation","title":"Experimental Data","text":"","category":"section"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"We have BOD measurements at five time points:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"t = [1, 2, 3, 4, 5]\nD = [0.18, 0.32, 0.42, 0.49, 0.54]\nœÉ = sqrt(1e-3)\nnothing # hide","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"Let's visualize the data along with model predictions for different parameter values:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"s = scatter(t, D, label=\"Data\", xlabel=\"Time (t)\", ylabel=\"Biochemical Oxygen Demand (D)\",\n    size=(600, 400), legend=:topleft)\n# Plot model output for some parameter values\nt_values = range(0, 5, length=100)\nfor x‚ÇÅ in [-0.5, 0, 0.5]\n    for x‚ÇÇ in [-0.5, 0, 0.5]\n        plot!(t_values, [forward_model(ti, [x‚ÇÅ, x‚ÇÇ]) for ti in t_values],\n              label=\"(x‚ÇÅ = $x‚ÇÅ, x‚ÇÇ = $x‚ÇÇ)\", linestyle=:dash)\n    end\nend\nsavefig(\"realizations-bod.svg\"); nothing # hide","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"(Image: BOD Realizations)","category":"page"},{"location":"Examples/bod_example/#Bayesian-Inference-Setup","page":"BOD Parameter Estimation","title":"Bayesian Inference Setup","text":"","category":"section"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"We define the posterior distribution using a standard normal prior on both parameters and a Gaussian likelihood for the observations:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"pi(mathbfyboldsymboltheta) = prod_t=1^5 frac1sqrt2pisigma^2expleft(-frac12sigma^2(y_t - mathcalB(t))^2right)","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"function posterior(x)\n    # Calculate the likelihood\n    likelihood = prod([pdf(Normal(forward_model(t[k], x), œÉ), D[k]) for k in 1:5])\n    # Calculate the prior\n    prior = pdf(Normal(0,1), x[1]) * pdf(Normal(0,1), x[2])\n    return prior * likelihood\nend\n\ntarget = MapTargetDensity(posterior, :auto_diff)","category":"page"},{"location":"Examples/bod_example/#Creating-and-Optimizing-the-Transport-Map","page":"BOD Parameter Estimation","title":"Creating and Optimizing the Transport Map","text":"","category":"section"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"We use a 2-dimensional polynomial transport map with degree 3 and Softplus rectifier:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"M = PolynomialMap(2, 3, :normal, Softplus())","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"Set up Gauss-Hermite quadrature for optimization:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"quadrature = GaussHermiteWeights(10, 2)","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"Optimize the map coefficients:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"@time res = optimize!(M, target, quadrature)\nprintln(\"Optimization result: \", res)","category":"page"},{"location":"Examples/bod_example/#Generating-Posterior-Samples","page":"BOD Parameter Estimation","title":"Generating Posterior Samples","text":"","category":"section"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"Generate samples from the standard normal distribution and map them to the posterior:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"samples_z = randn(1000, 2)","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"Map the samples through our transport map:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"mapped_samples = reduce(vcat, [evaluate(M, z)' for z in eachrow(samples_z)])","category":"page"},{"location":"Examples/bod_example/#Quality-Assessment","page":"BOD Parameter Estimation","title":"Quality Assessment","text":"","category":"section"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"Compute the variance diagnostic to assess the quality of our approximation:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"var_diag = variance_diagnostic(M, target, samples_z)\nprintln(\"Variance Diagnostic: \", var_diag)","category":"page"},{"location":"Examples/bod_example/#Visualization","page":"BOD Parameter Estimation","title":"Visualization","text":"","category":"section"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"Plot the mapped samples along with contours of the true posterior density:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"x‚ÇÅ = range(-0.5, 1.5, length=100)\nx‚ÇÇ = range(-0.5, 3, length=100)\n\nposterior_values = [posterior([x‚ÇÅ, x‚ÇÇ]) for x‚ÇÇ in x‚ÇÇ, x‚ÇÅ in x‚ÇÅ]\n\nscatter(mapped_samples[:, 1], mapped_samples[:, 2],\n        label=\"Mapped Samples\", alpha=0.5, color=1,\n        xlabel=\"x‚ÇÅ\", ylabel=\"x‚ÇÇ\", title=\"Posterior Density and Mapped Samples\")\ncontour!(x‚ÇÅ, x‚ÇÇ, posterior_values, colormap=:viridis, label=\"Posterior Density\")\nsavefig(\"samples-bod.svg\"); nothing # hide","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"(Image: BOD Samples)","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"Finally, we can compute the pullback density to visualize how well our transport map approximates the posterior:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"posterior_pullback = [pullback(M, [x‚ÇÅ, x‚ÇÇ]) for x‚ÇÇ in x‚ÇÇ, x‚ÇÅ in x‚ÇÅ]\n\ncontour(x‚ÇÅ, x‚ÇÇ, posterior_values./maximum(posterior_values);\n    levels = 5, colormap = :viridis, colorbar = false,\n    label=\"Target\", xlabel=\"x‚ÇÅ\", ylabel=\"x‚ÇÇ\")\ncontour!(x‚ÇÅ, x‚ÇÇ, posterior_pullback./maximum(posterior_pullback);\n    levels = 5, colormap = :viridis, linestyle=:dash,\n    label=\"Pullback\")\nsavefig(\"pullback-bod.svg\"); nothing # hide","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"(Image: BOD Pullback Density)","category":"page"},{"location":"Examples/bod_example/#Model-Parameter-Interpretation","page":"BOD Parameter Estimation","title":"Model Parameter Interpretation","text":"","category":"section"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"The posterior samples provide uncertainty quantification for the BOD model parameters:","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"x‚ÇÅ: Controls the maximum BOD level (parameter A)\nx‚ÇÇ: Controls the rate of BOD development (parameter B)","category":"page"},{"location":"Examples/bod_example/","page":"BOD Parameter Estimation","title":"BOD Parameter Estimation","text":"The correlation structure in the posterior reflects the interdependence between these parameters in explaining the observed data.","category":"page"},{"location":"#TransportMaps.jl","page":"Home","title":"TransportMaps.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"This is an implementation of triangular transport maps in Julia based on the description in [1]. For a comprehensive introduction to transport maps, see [2]. The theoretical foundations for monotone triangular transport maps are detailed in [1], [3]. For practical applications in structural health monitoring and Bayesian inference, see [4].","category":"page"},{"location":"#What-are-Transport-Maps?","page":"Home","title":"What are Transport Maps?","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Transport maps are smooth, invertible functions that can transform one probability distribution into another [1]. The mathematical foundation builds on the Rosenblatt transformation [5] and the Knothe-Rosenblatt rearrangement [6]. They are particularly useful for:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Sampling: Generate samples from complex distributions by transforming samples from simple distributions\nVariational inference: Approximate complex posterior distributions in Bayesian updating problems [4]\nDensity estimation: Learn the structure of complex probability distributions","category":"page"},{"location":"#Key-Features","page":"Home","title":"Key Features","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Polynomial Maps: Triangular polynomial transport maps\nAdaptive Construction: Automatic selection of polynomial terms for efficient approximation\nMultiple Rectifiers: Support for different activation functions (Softplus, ShiftedELU, Identity)\nQuadrature Integration: Multiple quadrature schemes for map optimization\nOptimization: Built-in optimization routines for fitting maps to target densities","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"using Pkg\nPkg.add(\"TransportMaps\")","category":"page"},{"location":"#Quick-Start-Example","page":"Home","title":"Quick Start Example","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Here's a simple example showing how to construct a transport map for a \"banana\" distribution:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using TransportMaps\nusing Distributions\n\n# Create a 2D polynomial map with degree 2 and Softplus rectifier\nM = PolynomialMap(2, 2, Softplus())\n\n# Set up quadrature for optimization\nquadrature = GaussHermiteWeights(3, 2)\n\n# Define target density (banana distribution)\ntarget_density(x) = pdf(Normal(), x[1]) * pdf(Normal(), x[2] - x[1]^2)\n\n# Optimize the map coefficients\nresult = optimize!(M, target_density, quadrature)\n\n# Generate samples by mapping standard Gaussian samples\nsamples_z = randn(1000, 2)\nmapped_samples = reduce(vcat, [evaluate(M, x)' for x in eachrow(samples_z)])\n\n# Evaluate map quality\nvariance_diag = variance_diagnostic(M, target_density, samples_z)","category":"page"},{"location":"#Package-Architecture","page":"Home","title":"Package Architecture","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The package is organized around several key components:","category":"page"},{"location":"#Map-Components","page":"Home","title":"Map Components","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"PolynomialMapComponent: Individual polynomial components of triangular maps\nHermiteBasis: Hermite polynomial basis functions\nMultivariateBasis: Multivariate polynomial basis construction","category":"page"},{"location":"#Transport-Maps","page":"Home","title":"Transport Maps","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"PolynomialMap: Main triangular polynomial transport map implementation","category":"page"},{"location":"#Rectifier-Functions","page":"Home","title":"Rectifier Functions","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"IdentityRectifier: No transformation (linear)\nSoftplus: Smooth positive transformation\nShiftedELU: Exponential linear unit variant","category":"page"},{"location":"#Quadrature-and-Optimization","page":"Home","title":"Quadrature and Optimization","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"GaussHermiteWeights: Gauss-Hermite quadrature points and weights\nMonteCarloWeights: Monte Carlo integration\nLatinHypercubeWeights: Latin hypercube sampling","category":"page"},{"location":"#API-Reference","page":"Home","title":"API Reference","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Pages = [\"api.md\"]","category":"page"},{"location":"#Authors","page":"Home","title":"Authors","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Lukas Fritsch, Institute for Risk and Reliability, Leibniz University Hannover\nJan Grashorn, Chair for Engineering Materials and Building Preservation, Helmut-Schmidt-University Hamburg","category":"page"},{"location":"#Related-Implementation","page":"Home","title":"Related Implementation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"ATM: Matlab code for adaptive transport maps [3]\nMParT: C++-based library for transport maps [7]\nTransportBasedInference.jl: Julia implementation of adaptive transport maps (ATM) and Kalman filters\nSequentialMeasureTransport.jl: Julia implementation of transport maps from sum-of-squares densities [8]\nTriangular-Transport-Toolbox: Python code for the triangular transport tutorial paper [2]","category":"page"}]
}
