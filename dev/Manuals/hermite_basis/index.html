<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basis Functions · TransportMaps.jl</title><meta name="title" content="Basis Functions · TransportMaps.jl"/><meta property="og:title" content="Basis Functions · TransportMaps.jl"/><meta property="twitter:title" content="Basis Functions · TransportMaps.jl"/><meta name="description" content="Documentation for TransportMaps.jl."/><meta property="og:description" content="Documentation for TransportMaps.jl."/><meta property="twitter:description" content="Documentation for TransportMaps.jl."/><meta property="og:url" content="https://lukasfritsch.github.io/TransportMaps.jl/Manuals/hermite_basis/"/><meta property="twitter:url" content="https://lukasfritsch.github.io/TransportMaps.jl/Manuals/hermite_basis/"/><link rel="canonical" href="https://lukasfritsch.github.io/TransportMaps.jl/Manuals/hermite_basis/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TransportMaps.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manuals</span><ul><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li class="is-active"><a class="tocitem" href>Basis Functions</a><ul class="internal"><li><a class="tocitem" href="#Probabilistic-Hermite-Basis"><span>Probabilistic Hermite Basis</span></a></li><li><a class="tocitem" href="#Linearized-Hermite-Basis"><span>Linearized Hermite Basis</span></a></li><li><a class="tocitem" href="#Edge-Controlled-(Weighted)-Hermite-Basis:-Gaussian-Weight"><span>Edge-Controlled (Weighted) Hermite Basis: Gaussian Weight</span></a></li><li><a class="tocitem" href="#Edge-Controlled-Hermite-Basis:-Cubic-Spline-Weight"><span>Edge-Controlled Hermite Basis: Cubic Spline Weight</span></a></li><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li></ul></li><li><a class="tocitem" href="../sparse_map/">Map Parameterization</a></li><li><a class="tocitem" href="../quadrature/">Quadrature Methods</a></li><li><a class="tocitem" href="../optimization/">Optimization</a></li><li><a class="tocitem" href="../conditional_densities/">Conditional Densities and Samples</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../Examples/banana_example/">Banana: Map from Density</a></li><li><a class="tocitem" href="../../Examples/mapfromsamples_example/">Banana: Map from Samples</a></li><li><a class="tocitem" href="../../Examples/bod_example/">BOD Parameter Estimation</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manuals</a></li><li class="is-active"><a href>Basis Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basis Functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/lukasfritsch/TransportMaps.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/lukasfritsch/TransportMaps.jl/blob/main/docs/literate/hermite_basis.jl#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basis-Functions"><a class="docs-heading-anchor" href="#Basis-Functions">Basis Functions</a><a id="Basis-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Basis-Functions" title="Permalink"></a></h1><p>In order to construct a parameterized map, we first need to define a suitable basis.</p><p>This manual describes the different one-dimensional basis families currently implemented in TransportMaps.jl. We focus on variants of the (probabilists&#39;) Hermite polynomials and recently proposed edge-controlled versions [<a href="../../references/#baptista2023">3</a>], [<a href="../../references/#ramgraber2025">2</a>].</p><h2 id="Probabilistic-Hermite-Basis"><a class="docs-heading-anchor" href="#Probabilistic-Hermite-Basis">Probabilistic Hermite Basis</a><a id="Probabilistic-Hermite-Basis-1"></a><a class="docs-heading-anchor-permalink" href="#Probabilistic-Hermite-Basis" title="Permalink"></a></h2><p>The probabilistic Hermite polynomials form an orthonormal basis with respect to the standard normal density</p><p class="math-container">\[\phi(z) = \frac{1}{\sqrt{2 \pi}} \exp\left(-\frac{z^2}{2}\right)\]</p><p>They satisfy the three-term recurrence <span>$\operatorname{He}_{n+1}(z)=z \operatorname{He}_n(z)-n \operatorname{He}_{n-1}(z) $ with $(\operatorname{He}_0(z)=1)$</span> and <span>$(\operatorname{He}_1(z)=z)$</span>.</p><p>Orthonormal polynomial bases such as the Hermite family are useful for several reasons. Orthogonality with respect to a reference measure makes coefficient estimation stable: projections onto the basis are simple inner products and a truncated series gives the best <span>$L^2$</span>-approximation under that measure. These properties are the same reasons orthogonal polynomials are used in Polynomial Chaos Expansions (PCE) for surrogate modelling and uncertainty quantification (see Sudret [<a href="../../references/#sudret2008">9</a>] for a concise introduction). In the Gaussian case the Hermite polynomials are the natural choice (Wiener–Askey scheme, see [<a href="../../references/#xiu2002">10</a>]).</p><p>We want to visualize the Hermite polynomials, first we load the necessary packages:</p><pre><code class="language-julia hljs">using Distributions
using Plots
using TransportMaps</code></pre><p>Then we construct the basis via <code>HermiteBasis()</code> or <code>HermiteBasis(:none)</code> (<code>:none</code> means no edge control):</p><pre><code class="language-julia hljs">basis = HermiteBasis()
z = -3:0.01:3

p1 = plot(xlabel=&quot;z&quot;, ylabel=&quot;Basis function&quot;, title=&quot;Standard Hermite Basis&quot;)
for degree in 0:4
    plot!(p1, z, map(x -&gt; basisfunction(basis, degree, x), z), label=&quot;degree $degree&quot;)
end</code></pre><p><img src="../hermite_basis_standard.svg" alt="Standard Hermite Basis"/></p><p>If we zoom out, we can see that the tails grow quickly for large <span>$|z|$</span>:</p><pre><code class="language-julia hljs">z = -7:0.1:7

p2 = plot(xlabel=&quot;z&quot;, ylabel=&quot;Basis function&quot;, title=&quot;Standard Hermite Basis&quot;)
for degree in 0:4
    plot!(p2, z, map(x -&gt; basisfunction(basis, degree, x), z), label=&quot;degree $degree&quot;)
end</code></pre><p><img src="../hermite_basis_standard_zoom.svg" alt="Standard Hermite Basis"/></p><h2 id="Linearized-Hermite-Basis"><a class="docs-heading-anchor" href="#Linearized-Hermite-Basis">Linearized Hermite Basis</a><a id="Linearized-Hermite-Basis-1"></a><a class="docs-heading-anchor-permalink" href="#Linearized-Hermite-Basis" title="Permalink"></a></h2><p>Linearized Hermite polynomials (edge-linearized basis) were introduced in [<a href="../../references/#baptista2023">3</a>] to control growth for large <span>$|z|$</span> by replacing the polynomial with a tangent line outside data-dependent bounds <span>$z^l,z^u$</span>:</p><p class="math-container">\[\mathcal{H}^{\mathrm{Lin}}_j(z)=\frac{1}{\sqrt{Z_{\alpha_j}}}
\begin{cases}
\mathrm{He}_j(z^l)+\mathrm{He}&#39;_j(z^l)(z-z^l), &amp; z&lt; z^l \\
\mathrm{He}_j(z), &amp; z^l\le z \le z^u \\
\mathrm{He}_j(z^u)+\mathrm{He}&#39;_j(z^u)(z-z^u), &amp; z&gt; z^u
\end{cases}\]</p><p>The bounds are chosen here as the 0.01 and 0.99 empirical quantiles of (reference) samples. Alternatively, they can be chosen as the quantiles of the respective reference density. The normalization constant <span>$Z_{\alpha_j}$</span> follows the definition in the paper: <span>$Z_{\alpha_j}=\alpha_j!$</span> for <span>$j&lt;k$</span> and <span>$Z_{\alpha_k}=(\alpha_k+1)!$</span>.</p><pre><code class="language-julia hljs">basis = LinearizedHermiteBasis(Normal(), 4, 1)
println(&quot;Linearization bounds: &quot;, basis.linearizationbounds)

p3 = plot(xlabel=&quot;z&quot;, ylabel=&quot;Basis function&quot;, title=&quot;Linearized Hermite Basis&quot;)
for degree in 0:4
    plot!(p3, z, map(x -&gt; basisfunction(basis, degree, x), z), label=&quot;degree $degree&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Linearization bounds: [-2.326347874040846, 2.326347874040846]</code></pre><p><img src="../hermite_basis_linearized.svg" alt="Linearized Hermite Basis"/></p><h2 id="Edge-Controlled-(Weighted)-Hermite-Basis:-Gaussian-Weight"><a class="docs-heading-anchor" href="#Edge-Controlled-(Weighted)-Hermite-Basis:-Gaussian-Weight">Edge-Controlled (Weighted) Hermite Basis: Gaussian Weight</a><a id="Edge-Controlled-(Weighted)-Hermite-Basis:-Gaussian-Weight-1"></a><a class="docs-heading-anchor-permalink" href="#Edge-Controlled-(Weighted)-Hermite-Basis:-Gaussian-Weight" title="Permalink"></a></h2><p>Edge control modifies each Hermite polynomial with a decaying weight to reduce growth in the tails [<a href="../../references/#ramgraber2025">2</a>]. Using a Gaussian weight gives:</p><p class="math-container">\[\mathcal{H}_j^{\text{Gauss}}(z)=\mathrm{He}_j(z)\exp\left(-\tfrac{z^2}{4}\right).\]</p><pre><code class="language-julia hljs">basis = GaussianWeightedHermiteBasis()

p4 = plot(xlabel=&quot;z&quot;, ylabel=&quot;Basis function&quot;, title=&quot;Gaussian-Weighted Hermite Basis&quot;)
for degree in 0:4
    plot!(p4, z, map(x -&gt; basisfunction(basis, degree, x), z), label=&quot;degree $degree&quot;)
end</code></pre><p><img src="../hermite_basis_gaussian.svg" alt="Gaussian Weighted Hermite Basis"/></p><div class="admonition is-info" id="Note-20f28531d1eabe3a"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-20f28531d1eabe3a" title="Permalink"></a></header><div class="admonition-body"><p>In order to preserve some extrapolation properties, the weights are only applied to polynomials of degree <span>$j \geq 2$</span>, as noted in [<a href="../../references/#ramgraber2025">2</a>].</p></div></div><h2 id="Edge-Controlled-Hermite-Basis:-Cubic-Spline-Weight"><a class="docs-heading-anchor" href="#Edge-Controlled-Hermite-Basis:-Cubic-Spline-Weight">Edge-Controlled Hermite Basis: Cubic Spline Weight</a><a id="Edge-Controlled-Hermite-Basis:-Cubic-Spline-Weight-1"></a><a class="docs-heading-anchor-permalink" href="#Edge-Controlled-Hermite-Basis:-Cubic-Spline-Weight" title="Permalink"></a></h2><p>A cubic spline weight smoothly damps the polynomials outside a radius <span>$r$</span>, also introduced in [<a href="../../references/#ramgraber2025">2</a>]. In this implementation, we define <span>$r$</span> based on the 0.01 and 0.99 quantile values <span>$z^l, z^u$</span>:</p><p class="math-container">\[\mathcal{H}_j^{\mathrm{Cub}}(z)=\operatorname{He}_j(z)\left(2 u^3-3 u^2+1\right),\qquad u=\min\!\left(1,\frac{|z|}{r}\right),\; r=2\max(|z^l|,|z^u|).\]</p><pre><code class="language-julia hljs">basis = CubicSplineHermiteBasis(Normal())

p5 = plot(xlabel=&quot;z&quot;, ylabel=&quot;Basis function&quot;, title=&quot;Cubic Spline Weighted Hermite Basis&quot;)
for degree in 0:4
    plot!(p5, z, map(x -&gt; basisfunction(basis, degree, x), z), label=&quot;degree $degree&quot;)
end</code></pre><p><img src="../hermite_basis_cubic.svg" alt="Cubic Spline Weighted Hermite Basis"/></p><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>We showcased four basis variants:</p><ul><li>Standard (orthonormal) Hermite</li><li>Linearized Hermite (piecewise linear tails)</li><li>Gaussian-weighted Hermite (exponential damping)</li><li>Cubic-spline-weighted Hermite (compact-style smooth damping)</li></ul><p>These can be supplied when constructing polynomial transport maps to tune stability, tail behavior, and sparsity characteristics.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../sparse_map/">Map Parameterization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 30 September 2025 14:00">Tuesday 30 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
